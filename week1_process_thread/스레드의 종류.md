# 스레드의 종류

- **하드웨어 스레드**
  - 하드웨어 스레드는 물리적인 CPU 코어 내에서 실제로 실행되는 스레드를 의미
  - CPU 아키텍쳐의 발달과 효율적으로 자원을 사용하기 위해 가상의 스레드라는 개념을 추가하여 각 CPU 코어가 동시에 여러 스레드를 실행할 수 있게 하는 기술을 사용하고 있다. (1 core - 2 threads) 이를 하이퍼 스레딩 또는 SMT(Simultaneous Multi-Threading) 라고 한다.
  - OS는 하드웨어 스레드를 실제 CPU 코어라고 생각하고 실행된다.
- **OS 스레드 (커널 수준의 스레드)**
  - 운영체제 시스템 내에서 생성되어 동작하는 스레드이다.
  - OS 스레드는 시스템 콜을 통해 관리되며, 커널에서 직접적으로 스케줄링을 담당한다.
  - CPU에서 실제로 실행되는 단위이다. (CPU 스케줄링의 단위)
- **유저 스레드 (사용자 수준 스레드)**
  - 스레드 개념을 프로그래밍 레벨에서 추상화 한 것으로, 사용자 단에서 생성 및 관리되는 스레드이다.
  - 따라서 커널이 알 수도 없고, 따로 관리하지 하지 않는 스레드이다.
  - 유저 스레드는 OS의 개입 없이 자체적으로 스케줄링할 수 있어 성능이 우수하지만, 커널 스케줄러와 연동되지 않기 때문에 한 스레드가 블록되면 전체 프로세스가 블록될 수 있습니다. (프로세스 단위의 Blocking이 발생한다)
  - 유저 스레드가 cpu에서 실행되려면 **커널 스레드와 반드시 연결돼야 한다.**



## 유저 스레드와 OS 스레드 연결 방법

유저 스레드와 OS 스레드를 연결하기 위해서는 유저 스레드 라이브러리가 OS 스레드와 상호 작용하도록 설계되어야 한다.
일반적으로 쓰레드 라이브러리는 스레드 생성, 스케줄링, 종료 등의 기능을 OS의 시스템 콜을 통해 호출함으로써 유저 스레드를 OS 스레드로 매핑할 수 있다.

### **One to One 모델**

유저 스레드 하나가 OS 스레드 하나에 대응되는 구조로 각각의 유저 스레드가 별도의 OS 스레드에서 실행된다. 즉 하나의 유저 스레드가 블록되어도 다른 스레드는 독립적으로 실행이 가능하다. 

이 모델에서는 유저 스레드와 OS 스레드가 1:1 매핑 관계를 가지기 때문에 스레드 관리를 전적으로 OS에 위임하게 된다. 때문에 커널이 직접 스케줄링을 한다. 

**특징**

하나의 스레드에서 Block I/O를 실행하더라도 다른 스레드로 실행할 수 있다.

멀티코어 시스템에서 성능이 우수하다. (멀티코어를 잘 활용함)

스레드 생성 비용이 크다.

자바 1.2 이후부터 사용 중인 방식이다.



### **Many to One 모델**

여러 개의 유저 스레드가 하나의 OS 스레드에 대응되는 구조이다. 유저 스레드의 스케줄링은 사용자 수준에서 처리되며, 운영체제는 단 하나의 스레드만 관리한다. 하나의 스레드에 여러 유저 스레드가 매핑되기 때문에 한 유저 스레드가 블록되면 전체 프로세스가 블록될 수 있다.

**특징**

- 유저 스레드 간 전환이 빠르다. (one-to-one 모델보다 빠르다)
- 스레드 생성 비용이 적다.
- 결국 실제로 동작하는 건 커널 스레드 하나 이기 때문에 멀티 코어를 활용하지 못한다.
- 한 스레드의 블로킹이 전체 스레드에 영향을 준다 (전체 스레드 block)
- Block 방지를 위해 non Block I/O 방식을 진행한다



### **Many to Many 모델**

여러 유저 스레드가 여러 OS 스레드에 매핑되는 구조이다. 이 모델에서는 유저 스레드와 OS 스레드가 독립적으로 관리되어 유연한 스케줄링이 가능하다.
동시에 유저 스레드 중 일부가 블록되어도 다른 스레드가 실행될 수 있다.

**특징**:

- 블로킹 문제 해결 가능
- 효율적인 자원 사용이 가능하다.
- 다른 매핑 방식에 비해서 스레드 관리, 구현 복잡도 증가한다.



## 참고자료

* [https://velog.io/@chanyoung1998/%EC%8A%A4%EB%A0%88%EB%93%9C%EC%9D%98-%EC%A2%85%EB%A5%98%ED%95%98%EB%93%9C%EC%9B%A8%EC%96%B4-%EC%8A%A4%EB%A0%88%EB%93%9C-OS-%EC%8A%A4%EB%A0%88%EB%93%9C-%EC%9C%A0%EC%A0%80-%EB%A0%88%EB%B2%A8-%EC%8A%A4%EB%A0%88%EB%93%9C](https://velog.io/@chanyoung1998/%EC%8A%A4%EB%A0%88%EB%93%9C%EC%9D%98-%EC%A2%85%EB%A5%98%ED%95%98%EB%93%9C%EC%9B%A8%EC%96%B4-%EC%8A%A4%EB%A0%88%EB%93%9C-OS-%EC%8A%A4%EB%A0%88%EB%93%9C-%EC%9C%A0%EC%A0%80-%EB%A0%88%EB%B2%A8-%EC%8A%A4%EB%A0%88%EB%93%9C)

* [https://www.youtube.com/watch?si=1W9A8bhvB2gjw0Sn&v=vorIqiLM7jc&feature=youtu.be](https://www.youtube.com/watch?si=1W9A8bhvB2gjw0Sn&v=vorIqiLM7jc&feature=youtu.be)